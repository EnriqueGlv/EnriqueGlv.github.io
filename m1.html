<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Efficient Execution of Deep Learning Kernels on Long Vector Machines</title>

  <meta name="description" content="Enrique Galvez's personal website. Contains information about my research works and contact information.">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />

  <!-- Base styles -->
  <link rel="stylesheet" href="newstyle.css">
  <link rel="stylesheet" href="project.css">

  <!-- Markdown + code highlighting styles -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link rel="stylesheet" href="https://unpkg.com/prismjs@1.24.1/themes/prism.css">
  <link rel="stylesheet" href="admon.css">

  <!-- Material icons -->
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css" rel="stylesheet">
</head>

<body>

  <!-- Navigation Bar -->
  <div class="page-header sticky top-0 z-30">
      <header id="site-header" class="header">
          <nav class="max-w-7xl mx-auto navbar px-3 flex justify-start">
              <div class="order-0 h-full">
                  <a class="navbar-brand" href="/#" title="Enrique Galvez">Enrique Galvez</a>
              </div>
              <input id="nav-toggle" type="checkbox" class="hidden">
              <label for="nav-toggle" class="order-3 cursor-pointer flex items-center lg:hidden text-[var(--color-header-fg)] lg:order-1">
                  <svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20">
                      <title>Open Menu</title>
                      <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"></path>
                  </svg>
                  <svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20">
                      <title>Close Menu</title>
                      <polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"></polygon>
                  </svg>
              </label>
              <ul id="nav-menu" class="ms-auto navbar-nav order-3 hidden lg:flex w-full lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-start">
                  <li class="nav-item"><a class="nav-link active" href="/#">Bio</a></li>
                  <li class="nav-item"><a class="nav-link" href="/#publications">Publications</a></li>
                  <!-- <li class="nav-item"><a class="nav-link" href="#talks">Talks</a></li> -->
                  <!-- <li class="nav-item"><a class="nav-link" href="/experience/">Experience</a></li> -->
                  <li class="nav-item"><a class="nav-link" href="/#projects">Projects</a></li>
                  <li class="nav-item"><a class="nav-link" href="/#teaching">Teaching</a></li>
              </ul>
          </nav>
      </header>
  </div>

  <!-- Project Content -->
  <section class="project-content-section">
    <div class="project-container">
      <div id="project-content" class="markdown-body">

        <h1>Efficient Execution of Deep Learning Kernels on Long Vector Machines</h1>
<p>During my first year of Master's degree, I worked as a research intern for 3 months at <a href="https://www.bsc.es/">Barcelona Supercomputing Center</a> (BSC). BSC is part of the <a href="https://www.european-processor-initiative.eu/">European Processor Initiative</a> (EPI) and the team I worked with was working on the conception of a RISC-V processor with a long SIMD vector length. In order to benchmark the new capacities of such a processor, efficient libraries should be designed for applications such as linear algebra or deep learning.</p>
<p>The purpose of my work was to design efficient vectorized algorithms for deep learning kernels such as pooling, ReLU and batch normalization. The motivation of my internship was to contribute to Alexandre De Limas Santana's PHD, which is about the vectorization of the convolution operator for the long SIMD processor developped at BSC.</p>
<h2>Writing vectorized kernels for long SIMD architectures</h2>
<p>SIMD architectures are very popular: most of recent processors already work with SIMD instructions usually with a fixed vector length between 64 and 512 bits. However, long SIMD architectures are relatively new and the design of efficient applications on such platforms presents some challenges.</p>
<p>Some of the challenges I identified are:</p>
<ul>
<li>Using an appropriate <strong>tensor format</strong> in memory: loading contiguous data is faster than gathering data from sparse (or strided) memory locations</li>
<li>Keeping a good <strong>data locality</strong> in order to decrease the number of memory accesses</li>
<li>Maximizing the <strong>use of vector length</strong> in order to benefit for full SIMD capabilities</li>
<li><strong>Compile-time optimizations</strong> such as loop-unrolling allow to further optimize the target application, with knowledge about the architecture</li>
</ul>
<p>By following these principles, I managed to obtain significant speedups (up to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>6</mn><mn>0</mn><mo>×</mo></mrow><annotation encoding="application/x-tex">60\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">6</span><span class="mord mathrm">0</span><span class="mbin">×</span></span></span></span> faster for batch normalization) of the vectorized implementations compared to sequential implementations. My implementations were written with the aim of being added to <a href="https://www.bsc.es/research-and-development/software-and-apps/software-list/oneapi-deep-neural-network-library-onednn/downloads">BSC's RISCVV extension of OneDNN</a>.</p>
<h2>Additionnal resources</h2>
<p>If you want to learn more about my work, here are some useful resources:</p>
<ul>
<li><a href="contents/m1-report.pdf">Internship report</a></li>
<li><a href="contents/m1-presentation.pdf">Internship Presentation</a></li>
<li><a href="https://dl.acm.org/doi/10.1145/3572848.3577435">Alexandre Santana's paper about convolutions</a></li>
<li><a href="https://www.bsc.es/research-and-development/software-and-apps/software-list/oneapi-deep-neural-network-library-onednn/downloads">BSC's RISCVV extension of OneDNN</a></li>
</ul>
<h2>Special thanks</h2>
<p>I am grateful to my supervisors Marc Casas and Alexandre De Limas Santana for allowing me to work on such an interesting project.</p>


      </div>
    </div>
  </section>

  <div class="quick-nav">
    <a href="index.html#projects" class="quick-nav-button">← Back to Projects</a>
  </div>

  <!-- Footer -->
  <footer class="page-footer text-center text-sm text-slate-700 dark:text-slate-200">
      &copy; 2025 Enrique Galvez. Inspired by Hugo Academic and academic webpages. 
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>
  <script>
    window.addEventListener("DOMContentLoaded", () => {
      new ClipboardJS(".markdown-it-code-copy");
    });
  </script>

</body>
</html>
